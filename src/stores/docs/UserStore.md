### Документация к `UserStore`

`UserStore` - это хранилище состояний для управления сессиями пользователя в приложении Vue.js с использованием
библиотеки `Pinia`.

#### Экспортирует 2 свойства:

1. `session` - непосредственно состояние сессии пользователя;
   ##### Структура состояния
   ```json
   {
     "userId": "INT // ID пользователя",
     "userName": "STRING // Имя пользователя",
     "loggedIn": "BOOLEAN // Статус входа в систему",
     "role": "STRING // Роль пользователя",
     "lastUpdate": "TIMESTAMP // timestamp последнего обновления данных с сервера",
     "profile": {
       "firstName": "STRING // Имя пользователя",
       "lastName": "STRING // Фамилия пользователя",
       "birthDate": "STRING // Дата рождения в формате YYYY-MM-DD",
       "gender": "STRING // Пол пользователя, например 'male' или 'female'",
       "phone": "STRING // Телефонный номер в формате '+7XXXXXXXXXX'",
       "email": "STRING // Электронная почта",
       "mailingSettings": {
         "digest": "BOOLEAN // Настройки рассылки: дайджесты",
         "eventsAgenda": "BOOLEAN // Настройки рассылки: агенда мероприятий",
         "educationalMaterials": "BOOLEAN // Настройки рассылки: учебные материалы",
         "submissionDeadlines": "BOOLEAN // Настройки рассылки: сроки сдачи работ"
       }
     }
   }
   ```
   ##### Методы:
    - `session.profile.updateWith(newProfile)` - принимает объект формата `session.profile`, использует его для
      обновления полей профиля:
        - не заменяет profile в session на новый, а отправляет его на сервер, где происходит слияние с проверкой имен
          полей;
        - следовательно, newProfile не обязательно передавать в полном виде, можно лишь часть, которую нужно обновить;
        - поля с некорректными именами будут проигнорированы сервером;
        - после обновления профиля на сервере, инициируется обновление данных на клиенте;

      ##### Особенности
    - Загружается и обновляется автоматически;
        - Учитывайте, что до загрузки свойства могут быть равны undefined или null;
        - Обращайтесь ко вложенным свойствам через `?.`, `val?.[index]?.attr`;
    - Если необходимо, можно запросить загрузку данных явно;

2. `sessionTools` - небольшой тулсет для работы с сессией;
   ##### Структура тулсета
    - `async loadSessionState()`: Асинхронный метод для проверки состояния текущей сессии.  
      Обновляет состояние сессии данными из ответа сервера.

    - `async tryToLogIn(login, password)`: Асинхронный метод для попытки входа в систему.      
      Принимает параметры `login` и `password`.  
      Возвращает ответ сервера в чистом виде; Обновляет состояние сессии при успехе.

    - `async tryToLogOut()`: Асинхронный метод для выхода из системы.  
      Возвращает ответ сервера в чистом виде; Обновляет состояние сессии при успехе.

    - `async reserveLogin(login)`: Асинхронный метод для резервирования логина.  
      Принимает параметр `login`.   
      Возвращает ответ сервера в чистом виде;

    - `async registerLogin(login, password)`: Асинхронный метод для регистрации нового логина.  
      Принимает параметры `login` и `password`;  
      Возвращает ответ сервера в чистом виде;

----

##### Использование

Для использования `UserStore` импортируйте его в ваш компонент Vue и вызывайте нужные методы для управления
сессией пользователя.

Пример:

```javascript
<script setup>
    import {useUserStore} from "@/stores/UserStore.js";

    const userStore = useUserStore();

    // Проверка состояния сессии
    await userStore.loadSessionState();

    // Вход в систему
    await userStore.tryToLogIn("user_login", "user_password");

    // Выход из системы
    await userStore.tryToLogOut();
    <script>
        <template>
            <pre>{{userStore?.session}}</pre>
        </template>
```

Обратите внимание, что все методы асинхронные и требуют использования `await` для корректной работы.  
Документацию по ответам и ошибкам, возвращаемым сервером, можно найти [здесь](../../backend/help.md).