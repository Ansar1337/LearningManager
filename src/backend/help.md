# Документация API Мок-Сервера

## Эндпоинты

API обрабатывает HTTP-запросы через один эндпоинт. URL эндпоинта - `https://rtlm.tableer.com`

## Методы запросов

- **POST**: сервер игнорирует любые запросы, кроме POST-запросов.
- **COOKIE**: сервер может обрабатывать установленные клиентом COOKIE, сервер также устанавливает собственные COOKIE для
  личных нужд.

## Формат данных

- **Входные данные** передаются в теле запроса в формате `application/x-www-form-urlencoded` или `multipart/form-data`.
- **Ответы** отправляются в формате JSON ([JSend-структура](https://github.com/omniti-labs/jsend)).

## Ошибки

При ошибке в поле `actor` будет возвращена ошибка:

```
{
  "status": "error",
  "data": "unknown actor"
}
```

При ошибке в поле `action`, специфичного для конкретного `actor` будет возвращена ошибка:

```
{
  "status": "error",
  "data": "unknown action"
}
```

Это единственные ошибки на данном уровне, все остальные являются специфичными для отдельных `action` и описаны ниже.

## Параметры запроса

- **actor**: Указывает на обработчик запроса.
- **action**: Определяет действие.
- **data**: JSON-объект с данными для обработки, опционально.

## Доступные вызовы

### Actor: `sessionManager`

- Назначение: обслуживание сессии/состояния
- Доступные `actions`:
    - **getSession**:
        - Описание: Возвращает текущее состояние сессии.
        - Параметры: Не требует дополнительных параметров.
        - Структура ответа:
          ```
          {
            "status": "success",
            "data": {
              "loggedIn": BOOLEAN, // флаг наличия сессии, по умолчанию 'false'
              "userName": STRING, // имя пользователя, по умолчанию 'Guest'
              "role": STRING // роль пользователя в системе, по умолчанию 'unknown'
            }
          }
          ```
        - Ошибки: Не предусмотрены.
    - **tryToLogOut**:
        - Описание: Очищает текущую сессию, отзывает аутентификацию.
        - Параметры: Не требует дополнительных параметров.
        - Структура ответа:
          ```
          {
            "status": "success",
            "data": "session flushed"
          }
          ```
        - Ошибки: Не предусмотрены.
    - **tryToLogIn**:
        - Описание: Аутентификация пользователя.
        - Параметры:
            - `login`: Логин пользователя.
            - `password`: Пароль пользователя.
        - Структура ответа:
          ```
          {
            "status": "success",
            "data": "access granted"
          }
          ```
        - Ошибки:
            - **unknown user**: Пользователь не найден.
              ```
              {
                "status": "error",
                "data": "unknown user"
              }
              ```
            - **corrupted data**: Неполные или некорректные данные.
              ```
              {
                "status": "error",
                "data": "corrupted data"
              }
              ```
    - **reserveLogin**:
        - Описание: Резервирует логин за пользователем перед регистрацией.
        - Параметры:
            - `login`: Логин пользователя.
            - Структура ответа:
              ```
              {
                "status": "success",
                "data": "login reserved"
              }
              ```
        - Ошибки:
            - **login occupied**: Логин уже занят.
               ```
               {
                 "status": "error",
                 "data": "login occupied"
               }
               ```
            - **empty login**: Передан пустой логин.
              ```
              {
                "status": "error",
                "data": "empty login"
              }
              ```
    - **registerLogin**:
        - Описание: Регистрирует логин в системе.
        - Параметры:
            - `login`: Логин пользователя.
            - `password`: Пароль пользователя.
            - Структура ответа:
              ```
              {
                "status": "success",
                "data": "login registered"
              }
              ```
        - Ошибки:
            - **login occupiedr**: Логин уже занят.
               ```
               {
                 "status": "error",
                 "data": "login occupied"
               }
               ```
            - **empty login**: Передан пустой логин.
              ```
              {
                "status": "error",
                "data": "empty login"
              }
              ```
            - **empty password**: Передан пустой пароль.
              ```
              {
                "status": "error",
                "data": "empty password"
              }
              ```
            - **login not reserved**: Попытка регистрации незарезервированного логина.
              ```
              {
                "status": "error",
                "data": "login not reserved"
              }
              ```

### Actor: `coursesManager`

- Назначение: обслуживание курсов/модулей
- Доступные `actions`:
    - **getAvailableCourses**
        - Описание: выгружает список с краткой информацией по доступным курсам
        - Параметры: Не требует дополнительных параметров.
        - Структура ответа:
            ```
            {
              "status": "success",
              "data": [{
                "title":"Название курса",
                "description":"Краткое описание курса"
              }, ...]
            }
            ```
            - Ошибки: Не предусмотрены.